<!DOCTYPE HTML>
<html>

<head>
  <script src="https://cdn.jsdelivr.net/npm/faunadb@latest/dist/faunadb.js"></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Text Uploader</title>
</head>

<body>
  <label style="font-family:'Segoe UI'">URL Ending</label><br>
  <input type="text" style="width:400px; height:20px; font-family:'Segoe UI'" id="name" placeholder="Enter a name..."><br><br>
    <label style="font-family:'Segoe UI'">Text Title</label><br>
  <input type="text" style="width:400px; height:20px; font-family:'Segoe UI'" id="title" placeholder="Enter something..."><br><br>
      <label style="font-family:'Segoe UI'">Uploader</label><br>
  <input type="text" style="width:400px; height:20px; font-family:'Segoe UI'" id="uploader" placeholder="Enter something..."><br><br>
      <label style="font-family:'Segoe UI'">Text Contents</label><br>
  <textarea style="width:400px; height:20px; font-family:'Segoe UI'" id="content" placeholder="Enter something..."></textarea><br><br>
  <button style="width:100px; height:25px; font-family:'Segoe UI'; margin:10px" onclick="create()">Create</button><br>
  <label id="result" style="font-family:'Segoe UI'">URL will appear here.</label>
  <script>
     var faunadb = window.faunadb
  var q = faunadb.query
  var client = new faunadb.Client({
    secret: 'fnAEWN0RMFAAwFxR2C5vwBRsORnw7OriYRS0cvVd',
    domain: 'db.eu.fauna.com',
    scheme: 'https',
  })
 
function create(){
  
    var date = new Date();
  
client.query(
  q.Get(
    q.Match(q.Index('posts_by_title'), document.getElementById("name").value)
  )
)
.then((ret) => 
      
document.getElementById("result").innerHTML = "This name is taken."

)
  
.catch(function(e){
    client.query(
  q.Create(
    q.Collection('text-db'),
    { data: { title: document.getElementById("name").value, titlereal: document.getElementById("title").value, uploader:  document.getElementById("uploader").value, creationdate: "<b>" + date.getDate() + "/" + (date.getMonth() + 1) + "/" + date.getFullYear() + "</b> at <b>" + date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds() + "</b><i>(Uploader's Local Time)</i>", contents: document.getElementById("content").value.replace(new RegExp('\n','g'), 'linebreak')} },
  )
)
.then((ret) =>
     
     document.getElementById("result").innerHTML = "https://textonline.github.io/?" + ret.data.title
     )
});




}
    </script>
</body>

</html>
